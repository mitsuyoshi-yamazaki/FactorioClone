# Factorioクローン プロジェクト要件定義書

## 1. プロジェクト概要

### 1.1 目的
プレイアブルなクラフトゲームを作成することにより、クラフトゲームの実装方法を確認・学習する

### 1.2 選定理由
Factorioを参考モデルとして選定した理由：
- プロジェクトオーナーがプレイヤーおよびmodderとしてFactorioの深い知識を持つ
- 明確なゲームメカニクスと実装パターンが存在する

## 2. 機能要件

### 2.1 必須実装機能

#### 2.1.1 プレイヤーシステム
- **移動機能**
  - WASDまたは矢印キーによる8方向移動

- **インタラクション**
  - 採掘・採集アクション（資源ノードからアイテム取得）
  - 手動クラフト機能（インベントリ内でレシピに基づくアイテム作成）
  - 設備の設置アクション
  - 設備の撤去アクション（設置物をインベントリに回収）

#### 2.1.2 物流システム
- **ベルトコンベア（Belt）**
  - アイテムの自動輸送
  - 方向制御（直線、カーブ、T字分岐）
  - 複数速度タイプ（最低でも1種類、可能なら黄・赤・青の3段階）

- **インサータ（Inserter）**
  - ベルト⇔設備間のアイテム移動
  - 設備⇔設備間のアイテム移動
  - 取得元・配置先の自動認識

#### 2.1.3 生産システム
- **組立機（Assembler）**
  - レシピベースの自動クラフト
  - 入力・出力スロット
  - クラフト進行状況の可視化
  - 複数の組立機タイプ（最低1種類、可能なら速度違いで複数）

### 2.2 明示的に除外する機能

- **マルチプレイヤー要素**（シングルプレイのみ）
- **敵対要素（Biter）**およびそれに関連する全て
- **戦闘システム**（攻撃、防御、武器、ターレット等）
- **研究システム**（全技術は最初から利用可能）
- **鉄道システム**（列車、レール、信号等）
- **回路ネットワーク**（論理回路、条件付き制御等）
- **流体システム**（パイプ、ポンプ、タンク等）
- **電力システム**の詳細な実装（電力容量のみの簡略化した実装 太陽光発電機と蓄電池も除外）

## 3. 非機能要件

### 3.1 パフォーマンス
- 60 FPSでの安定動作（標準的なPC環境）
- 最低100個の稼働設備での快適な動作

### 3.2 ユーザビリティ
- 直感的なUI/UX
- Factorioプレイヤーが違和感なく操作可能
- 基本的なキーボードショートカット対応

### 3.3 拡張性
- モジュラーな設計による機能追加の容易性
- データドリブンな実装（レシピ、アイテム定義等）

## 4. ゲーム仕様

### 4.1 簡略化方針
- **資源種類の削減**
  - 必須：鉄鉱石、銅鉱石、石炭、石
  - オプション：原油（流体システム実装時）

- **中間生成物の簡略化**
  - 基本的な中間素材のみ（鉄板、銅板、歯車、電子回路等）
  - ロケット部品は大幅に簡略化

- **勝利条件**
  - 簡略化されたレシピによるロケット打ち上げ

### 4.2 マップ仕様
- 固定マップまたは簡易的な手続き生成
- 最小サイズ：100x100タイル
- 推奨サイズ：500x500タイル

## 5. 入力システム仕様

### 5.1 操作デバイス
- **キーボード + マウス**による操作
- コントローラー対応は実装しない

### 5.2 操作方法
- **移動**：WASDによる8方向移動
- **インタラクション**：マウスクリックによる対象選択・実行
- **UIモード切り替え**：必須機能として実装
  - 通常モード（移動・採掘）
  - 設置モード（設備配置）
  - 削除モード（設備撤去）
  - インベントリモード
- **ショートカット**：実装しない（簡略化のため）

## 6. 技術的考慮事項（要検討）

### 6.1 確定した技術的仕様

1. **電力システム**
   - 簡易的な電力グリッドシステムを実装
   - 供給電力量 < 需要電力量の場合、そのグリッド内の全電力消費設備が停止
   - 供給電力量 ≥ 需要電力量の場合、設備は再起動
   - 太陽光発電機と蓄電池は除外（簡略化のため）

2. **インベントリシステム**
   - 実装の困難がない限りFactorioの設定を継承
   - プレイヤーインベントリサイズ、アイテムスタック制限等

3. **物理・衝突判定**
   - プレイヤーと設備の衝突判定は実装しない（オプション）
   - 設備同士の配置制限は実装しない（オプション）

4. **セーブ・ロード機能**
   - **必須機能として優先実装**
   - ゲーム状態の完全な永続化

5. **グラフィックス**
   - **2D簡易図形**による表現
   - 四角形、円形等の基本図形でゲームオブジェクトを描画
   - スプライトアセット不要、開発効率を重視

### 6.2 明示的に除外する要素

6. **サウンド・音楽**
   - **完全に除外**（実装しない）
   - 開発リソースの集中のため

7. **流体システム**
   - **完全に除外**（原油関連の生産チェーンは実装しない）
   - 代替案：石炭発電のみで電力を供給

### 6.3 実装後に検討する要素

8. **UIフレームワーク**
   - インベントリUI
   - クラフトメニュー
   - 設備設定画面

### 6.4 実装技術の決定
以下は要件確定後に検討・決定する：
- プログラミング言語・フレームワーク
- アーキテクチャ設計（ECS vs OOP等）
- パフォーマンス最適化手法
- データ永続化方式

## 7. 開発フェーズ案

### Phase 1: 基礎システム
- プレイヤー移動とマップ
- 基本的なインベントリ
- アイテム定義システム

### Phase 2: 採掘と手動クラフト
- 資源ノードと採掘
- 手動クラフトUI
- 設備の設置・撤去

### Phase 3: 自動化基盤
- ベルトコンベアシステム
- インサータ実装
- 組立機の基本動作

### Phase 4: ゲームループ完成
- レシピチェーンの実装
- 勝利条件
- バランス調整

### Phase 5: ポリッシュ（オプション）
- UI/UXの改善
- パフォーマンス最適化
- 追加コンテンツ

## 8. リスクと対策

- **技術的複雑性**：段階的実装により複雑性を管理
- **パフォーマンス問題**：早期のプロファイリングと最適化
- **スコープクリープ**：MVPの明確な定義と遵守

## 9. 成功基準

- 採掘から自動化までの基本的なゲームループが機能する
- 最低5種類のレシピチェーンが実装されている
- 30分以上の継続的なゲームプレイが可能
- 明確な目標（勝利条件）が達成可能